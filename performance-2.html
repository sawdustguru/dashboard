<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Data Display</title>
    <style>
        /* Your CSS styles */
    </style>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        window.onload = function () {
            const table = document.getElementById('dataTable');
            let totalPercentage = 0;
            let rowCount = 0;

            // Function to handle Google Sheets API
            function handleClientLoad() {
                gapi.load('client:auth2', initClient);
            }

            function initClient() {
                gapi.client.init({
                    apiKey: 'YOUR_API_KEY',
                    discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
                }).then(function () {
                    // Fetch data from Google Sheets API
                    fetchSheetData();
                });
            }

            function fetchSheetData() {
                gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: 'YOUR_SPREADSHEET_ID',
                    range: 'hours' // Fetch the named range 'hours'
                }).then(function (response) {
                    var range = response.result;
                    if (range.values.length > 0) {
                        // Parse and display data
                        parseData(range.values);
                    } else {
                        console.log('No data found.');
                    }
                }, function (response) {
                    console.log('Error: ' + response.result.error.message);
                });
            }

            // Function to parse and display data
            function parseData(values) {
                // Your parsing logic here
                // Example:
                values.forEach(function (row) {
                    const rowData = row.split(',');
                    if (rowData[0]) { // Check if data exists
                        // Create table rows and populate data accordingly
                        const tr = document.createElement('tr');
                        // Add cells and populate data accordingly
                        // Example:
                        const td1 = document.createElement('td');
                        td1.textContent = rowData[0]; // Name
                        tr.appendChild(td1);

                        const td2 = document.createElement('td');
                        td2.textContent = rowData[1]; // Weekly Hours
                        tr.appendChild(td2);

                        const td3 = document.createElement('td');
                        td3.textContent = rowData[2]; // YTD Performance
                        tr.appendChild(td3);

                        // Append the row to the table
                        table.appendChild(tr);
                    }
                });
            }

            // Call handleClientLoad when the page is fully loaded
            handleClientLoad();
        };
    </script>
</head>
<body>
    <div class="content-container">
        <!-- Your HTML content -->
        <table id="dataTable" border="1"></table>
    </div>
</body>
</html>
