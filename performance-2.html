<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Data Display</title>
    <style>
        /* Your CSS styles */
    </style>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        window.onload = function () {
            const table = document.getElementById('dataTable');
            let totalPercentage = 0;
            let rowCount = 0;

            // Function to handle Google Sheets API
            function handleClientLoad() {
                gapi.load('client:auth2', initClient);
            }

            function initClient() {
                gapi.client.init({
                    apiKey: 'AIzaSyCFvX56uc0WNPz2ZTJhpg7Q2pFOgZxt7-0',
                    discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
                }).then(function () {
                    // Fetch data from Google Sheets API
                    fetchSheetData();
                });
            }

            function fetchSheetData() {
                gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: '1Em_4WKvdHbWu5WR2HCkd4JRVFaTsjJsqPHqDPRj8Gxs',
                    range: 'hours' // Fetch the named range 'hours'
                }).then(function (response) {
                    var range = response.result;
                    if (range.values.length > 0) {
                        // Parse and display data
                        parseData(range.values);
                    } else {
                        console.log('No data found.');
                    }
                }, function (response) {
                    console.log('Error: ' + response.result.error.message);
                });
            }

            // Function to parse and display data
           function parseData(values) {
    // Assuming each row in the values array is an array itself
    values.forEach(function (row) {
        if (row.length >= 3) { // Ensure the row contains at least three elements
            // Create table row
            const tr = document.createElement('tr');

            // Add cells and populate data accordingly
            const td1 = document.createElement('td');
            td1.textContent = row[0]; // Name
            tr.appendChild(td1);

            const td2 = document.createElement('td');
            td2.textContent = row[1]; // Weekly Hours
            tr.appendChild(td2);

            const td3 = document.createElement('td');
            td3.textContent = row[2]; // YTD Performance
            tr.appendChild(td3);

            // Append the row to the table
            table.appendChild(tr);
        }
    });
}


            // Call handleClientLoad when the page is fully loaded
            handleClientLoad();
        };
    </script>
</head>
<body>
    <div class="content-container">
        <!-- Your HTML content -->
        <table id="dataTable" border="1"></table>
    </div>
</body>
</html>
