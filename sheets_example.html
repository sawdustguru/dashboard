<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Data Display</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        gapi.load('client', initClient);

        function initClient() {
            gapi.client.init({
                apiKey: 'AIzaSyCFvX56uc0WNPz2ZTJhpg7Q2pFOgZxt7-0',
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            }).then(function() {
                loadGoogleSheetData();
            });
        }

        function loadGoogleSheetData() {
            gapi.client.sheets.spreadsheets.values.batchGet({
                spreadsheetId: '1Em_4WKvdHbWu5WR2HCkd4JRVFaTsjJsqPHqDPRj8Gxs',
                ranges: ['gauge_data', 'hours', 'hours_pdi'], // Named ranges
            }).then(function(response) {
                var rangeData = response.result.valueRanges;
                // Display each range in a separate table
                rangeData.forEach((data, index) => {
                    if (data.values.length > 0) {
                        var tableName = ['Gauge Data', 'Hours', 'Hours PDI'][index]; // For display purposes
                        displayDataInTable(data.values, tableName);
                    } else {
                        console.error('No data found in range: ' + index);
                    }
                });
            }, function(error) {
                console.error('Error loading data from Google Sheet:', error);
            });
        }

        function displayDataInTable(data, tableName) {
            console.log(tableName + ":", data);
            var table = document.createElement('table');
            var caption = table.createCaption();
            caption.textContent = tableName;

            // Create header row
            var headerRow = table.insertRow();
            data[0].forEach(function(headerTitle) {
                var headerCell = document.createElement('th');
                headerCell.textContent = headerTitle;
                headerRow.appendChild(headerCell);
            });

            // Create data rows
            for (var i = 1; i < data.length; i++) { // Assuming first row is headers
                var row = table.insertRow();
                data[i].forEach(function(cellData) {
                    var cell = row.insertCell();
                    cell.textContent = cellData;
                });
            }

            document.body.appendChild(table);
        }
    </script>
</head>
<body>
    <!-- Tables will be dynamically created here -->
</body>
</html>
